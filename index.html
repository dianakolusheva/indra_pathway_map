<!doctype html>
<html>
<head>
    <title>INDRA Interactive Map</title>
    <!-- CSS -->
    <link href="static/style.css" rel="stylesheet" type="text/css" />

    <!-- bower:css -->
    <link rel="stylesheet" href="static/bower_components/qtip2/jquery.qtip.min.css" />
    <link rel="stylesheet" href="static/bower_components/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="static/bower_components/bootstrap-select/dist/css/bootstrap-select.css" />
    <link rel="stylesheet" href="static/bower_components/cytoscape-panzoom/cytoscape.js-panzoom.css" />
    <link rel="stylesheet" href="static/bower_components/components-font-awesome/css/fontawesome-all.css" />
    <link rel="stylesheet" href="static/bower_components/seiyria-bootstrap-slider/dist/css/bootstrap-slider.css" />
    <link rel="stylesheet" href="static/bower_components/bootstrap-toggle/css/bootstrap-toggle.min.css" />
    <!-- endbower -->
    <!-- bower:js -->
    <script src="static/bower_components/jquery/dist/jquery.js"></script>
    <script src="static/bower_components/cytoscape/dist/cytoscape.js"></script>
    <script src="static/bower_components/lodash/lodash.js"></script>
    <script src="static/bower_components/graphlib/dist/graphlib.core.js"></script>
    <script src="static/bower_components/dagre/dist/dagre.core.js"></script>
    <script src="static/bower_components/cytoscape-dagre/cytoscape-dagre.js"></script>
    <script src="static/bower_components/webcola/WebCola/cola.min.js"></script>
    <script src="static/bower_components/cytoscape-cola/cytoscape-cola.js"></script>
    <script src="static/bower_components/ev-emitter/ev-emitter.js"></script>
    <script src="static/bower_components/imagesloaded/imagesloaded.js"></script>
    <script src="static/bower_components/qtip2/jquery.qtip.min.js"></script>
    <script src="static/bower_components/cytoscape-qtip/cytoscape-qtip.js"></script>
    <script src="static/bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="static/bower_components/bootstrap-select/dist/js/bootstrap-select.js"></script>
    <script src="static/bower_components/cytoscape-panzoom/cytoscape-panzoom.js"></script>
    <script src="static/bower_components/seiyria-bootstrap-slider/dist/bootstrap-slider.js"></script>
    <script src="static/bower_components/renderjson/index.js"></script>
    <script src="static/bower_components/FileSaver.min/index.js"></script>
    <script src="static/bower_components/bootstrap-toggle/js/bootstrap-toggle.min.js"></script>
    <script src="static/bower_components/notifyjs/dist/notify.js"></script>
    <!-- endbower -->
    <!-- d3 -->
    <script src="https://d3js.org/d3-array.v1.min.js"></script>
    <script src="https://d3js.org/d3-collection.v1.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-format.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-time.v1.min.js"></script>
    <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
    <script src="https://d3js.org/d3-scale.v1.min.js"></script>
    <!-- d3 -->
    <!-- js -->
    <script src="static/js/drawCytoscape.js"></script>
    <script src="static/js/contextualizeNodesCCLE.js"></script>
    <script src="static/js/get_cy_gene_names.js"></script>
    <script src="static/js/phosphoContextSN.js"></script>
    <script src="static/js/qtipNodes.js"></script>
    <script src="static/js/highlightPath.js"></script>
    <script src="static/js/requests_APIs.js"></script>
    <script src="static/js/array_multifilter.js"></script>
    <script src="static/js/modalEdges.js"></script>
    <script src="static/js/base_script.js"></script>
    <!-- js -->

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <!-- container-fluid : start -->
    <div class="container-fluid">

    <div class=row>
        <div class="col-sm-6 col-xs-6 padding-0">
            <img src="indra_logo_v2.png" alt="INDRA logo" style="height:30px;"></img> <span class="hidden-xs" style="font:30px bold;text-align: center; vertical-align: middle;">INDRA-IPM</span>
        </div>
        <!-- <div class="col-sm-4 col-xs-4 hidden-xs pull-left padding-0" style="font:30px bold;">INDRA-IPM</div> -->
      <div class='col-sm-6 col-xs-6 pull-right'>
        <!-- Button trigger modal -->

            <button type="button" class="btn btn-default btn-lg pull-right" data-toggle="modal" data-target="#menu">
            <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span>
            <b class="hidden-xs">MODEL OPTIONS</b>
            </button>




        <!-- Modal -->
        <div class="modal" id="menu" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
                    <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="false">&times;</span></button>
                          </div>
              <div class="modal-body">
                  <div class="tabbable">
                  <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#byom">Build</a></li>
                    <li ><a data-toggle="tab" href="#context">Context</a></li>
                    <!-- <li ><a data-toggle="tab" href="#phospho">Phospho</a></li> -->
                    <li ><a data-toggle="tab" href="#ras227">Prebuilt models</a></li>
                    <li ><a data-toggle="tab" href="#about">About</a></li>
                  </ul>

                <div class="tab-content">
                  <div id="ras227" class="tab-pane fade in">
                    <div>
                        <br>
                        <div>
                            <select id='model_picker' class="selectpicker">
                                <option value="McCormick">NCI RAS Pathway 1.0</option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <button id='loadButtonStatic' type="submit" class="btn btn-primary">Load</button>
                  </div>

                  <div id="byom" class="tab-pane fade in active">
    <br>
    <div>
      <form>
          <div class="form-group">
            <label for="textArea">Describe your mechanism.</label>
            <textarea class="form-control" id="textArea" rows="15" autocomplete="off">
Growth-factor proteins activate EGFR, ERBB2, FGFR, PDGFR, MET, ROS1, and ALK.
EGFR, ERBB2, PDGFR, MET, ROS1, ALK and FGFR activate GRB2 and SHC.
GRB2 and SHC activate RASGRF and SOS.
GRB2 binds SHC.
SOS and RASGRF activate HRAS, NRAS and KRAS.
RASGRP activates HRAS, KRAS and NRAS.
SPRY deactivates HRAS, KRAS and NRAS.
RASA/ARHGAP35 deactivates HRAS, NRAS and KRAS.
RASAL deactivates HRAS, NRAS and KRAS.
NF1/SPRED deactivates HRAS, NRAS and KRAS.
RASA/ARHGAP35 deactivates RHOA, RHOB and RHOC.
RASAL deactivates RHOA, RHOB and RHOC.
NF1/SPRED deactivates RHOA, RHOB and RHOC.
HRAS, NRAS and KRAS activate RALGDS.
RALGDS activates RALA and RALB.
HRAS, NRAS and KRAS activate ARAF, BRAF and RAF1.
ARAF, BRAF and RAF1 activate MAP2K1 and MAP2K2.
MAP2K1 and MAP2K2 activate MAPK1 and MAPK3.
MAPK1 and MAPK3 activate ETS, JUN and FOS.
KSR binds ARAF, BRAF and RAF1.
KSR binds MAP2K1 and MAP2K2.
KSR binds MAPK1 and MAPK3.
ETS, FOS and JUN activate MDM2, CCND1 and DUSP.
MDM2 deactivates TP53.
CCND1 activates CDK4 and CDK6, which deactivate RB1.
DUSP deactivates MAPK1 and MAPK3.
SOS and RASGRF activate RHOA, RHOB and RHOC.
RHOA, RHOB and RHOC activate ROCK1 and ROCK2.
HRAS, NRAS and KRAS activate PIK3C and PIK3R.
PIK3C and PIK3R activate PIP3.
PTEN deactivates PIP3.
PIP3 activates PDPK1, AKT and TIAM.
PDPK1 activates AKT.
AKT deactivates TSC1/TSC2.
TSC1/TSC2 deactivates RHEB.
RHEB activates mTORC2.
STK11 activates PRKAA, PRKAB and PRKAG.
PRKAA, PRKAB and PRKAG deactivate mTORC2.
mTORC2 deactivates EIF4EBP1.
mTORC2 activates RPS6KB1 and RPS6KB2.
TIAM activates RAC, which activates PAK.
            </textarea>
          </div>

       </form>

          <div class= 'btn-div'>
              <div><b>NLP system to read with</b></div>
              <button id='parseReach' type="submit" class="btn btn-default parserSelect active">REACH</button>
              <button id='parseTrips' type="submit" class="btn btn-default parserSelect">TRIPS</button>
          </div>

          <hr>
          <div class= 'btn-div'>
              <button id='loadButtonDynamic' type="submit" class="btn btn-primary">Build</button>
          </div>
    </div>

</div>
                  <div id="context" class="tab-pane fade in">
                      <div >
                          <div class="form-group">
                              <br>
                              <div>
                                  <label for="cellSelectDynamic">Choose a cell line.</label>
                              </div>
                              <div>
                                  <select id='cellSelectDynamic' class="selectpicker"></select>
                              </div>
                              <br>
                              <button id='loadContextButton' type="submit" class="btn btn-primary">Load</button>
                          </div>


                      </div>
                  </div>

                  <!-- <div id="phospho" class="tab-pane fade in">
                      <div >
                          <div class="form-group">
                              <br>
                              <span>
                                  <select id='drug_select' title="drug" label="Drug" class="selectpicker ctx-select" data-width=20%></select>
                                  <select id='conc_select' title="concentration" label ="Concentration" class="selectpicker ctx-select" data-width=20%></select>
                                  <select id='time_select' title="timepoint" class="selectpicker ctx-select" data-width=20%></select>
                                  <select id='cell_line_select' title="cell line" class="selectpicker ctx-select" data-width=20%></select>
                                  <button id='load_context' type="submit" class="btn btn-primary">Load</button>
                                  <button id='reset_filter' type="submit" class="btn btn-danger">Reset</button>
                              </span>
                              <hr>
                              <table id="path_table" class="display" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th>Path</th>
                                        <th>Start</th>
                                        <th>End</th>
                                        <th>Length</th>
                                        <th>Score</th>
                                        <th>id</th>
                                    </tr>
                                </thead>
                            </table>


                          </div>
                      </div>
                  </div> -->

                  <div id="about" class="tab-pane fade in">
                    <br>
                    <div class="panel-group">
                        <!-- panel 1 start -->
                        <div class="panel panel-default">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#collapse1">How do I read this map?</a>
                            </h4>
                          </div>
                          <div id="collapse1" class="panel-collapse collapse">
                            <div class="panel-body">
                                <li>Nodes represent genes.</li>
                                <li>Nodes that are subdivided into pie charts represent families.</li>
                                <li>Wild-type genes are colored <font color="green">green.</font></li>
                                <li>Mutated genes are colored <font color="orange">orange.</font></li>
                                <li>The intensity of each color corresponds to the expression level of a gene in CCLE.</li>
                                <li>Clicking any node provides additional context by linking out to CiteAb, HGNC, and UniProt.</li>
                                <li>Clicking any edge will allow a user to filter the sources and targets of that edge and make a request for evidence found in literature and curated database that is stored in INDRA DB.</li>
                                <li><a href="https://www.cancer.gov/research/key-initiatives/ras/ras-central/blog/2014/what-do-we-mean-ras-pathway">The RAS Pathway Map</a> model was drawn by Dr. Frank McCormick at the NCI RAS Initiative.</li>
                            </div>
                          </div>
                        </div>
                        <!-- panel 1 end -->
                        <!-- panel 2 start -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" href="#collapse2">Build your own model from text</a>
                                </h4>
                            </div>
                            <div id="collapse2" class="panel-collapse collapse">
                                <div class="panel-body">
                                <ul>
                                    <li>Open the Build tab.</li>
                                    <li>Enter a list of sentences describing biological mechanisms.</li>
                                    <li>Click load and exit the menu.</li>
                                    <li>Your model should be ready momentarily.</li>
                                    <li>The text example in Build is a description of Frank McCormick's Ras Pathway diagram.</li>
                                </ul>
                                </div>
                            </div>
                        </div>
                        <!-- panel 2 end -->
                        <!-- panel 3 start -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" href="#collapse3">Model context</a>
                                </h4>
                            </div>
                            <div id="collapse3" class="panel-collapse collapse">
                                <div class="panel-body">
                                <ul>
                                    <li>Network models can be contextualized using the Context tab.</li>
                                    <li>Users can load gene expression and mutation data from each of the 900+ cell lines available in the <a href="https://portals.broadinstitute.org/ccle">CCLE</a>.</li>
                                    <li>We access a publicly available version of the CCLE hosted on <a href="http://www.cbioportal.org/study?id=cellline_ccle_broad">cBio Portal</a>.</li>
                                </ul>
                                </div>
                            </div>
                        </div>
                        <!-- panel 3 end --> 
                        <!-- panel 4 start -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" href="#collapse4">How does this work?</a>
                                </h4>
                            </div>
                            <div id="collapse4" class="panel-collapse collapse">
                                <div class="panel-body">
                                <ul>
                                    <li>All models are generated using <a href="https://github.com/sorgerlab/indra">INDRA</a> developed by the <a href="http://hits.harvard.edu/the-program/laboratory-of-systems-pharmacology/about/">Laboratory of Systems Pharmacology</a> at Harvard Medical School.</li>
                                    <li>The underlying API is available at <a href="api.indra.bio:8000">api.indra.bio:8000</a> and documented at: <a href="http://pathwaymap.indra.bio/api">http://pathwaymap.indra.bio/api</a></li>
                                    <li>Natural language processing is done using the <a href="https://github.com/clulab/reach">REACH</a> natural language processor developed by the CLU Lab at the University of Arizona or the <a href="https://www.ihmc.us/trips/">TRIPS</a> processor developed by IHMC.</li>
                                    <li>Interactive network visualizations are implemented in <a href="http://js.cytoscape.org">cytoscape.js</a></li>
                                    <li><a href="http://www.colorbrewer2.org">Colorbrewer2</a> was used to select colorscales for models rendered with D3.js</li>
                                </ul>
                                </div>
                            </div>
                        </div>
                        <!-- panel 4 end -->
                        <!-- panel 5 start -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" href="#collapse5">Funding</a>
                                </h4>
                            </div>
                            <div id="collapse5" class="panel-collapse collapse">
                                <div class="panel-body">
                                <ul>
                                    <li>This work was funded by ARO Grants W911NF‐14‐1‐0397 and W911NF‐15‐1‐0544 under the DARPA Big Mechanism and Communicating with Computers programs, and by NIGMS Grant P50GM107618 to Peter K. Sorger.</li>
                                </ul>
                                </div>
                            </div>
                        </div>
                        <!-- panel 5 end -->
                        <!-- panel 6 start -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" href="#collapse6">Privacy</a>
                                </h4>
                            </div>
                            <div id="collapse6" class="panel-collapse collapse">
                                <div class="panel-body">
                                <ul>
                                        <li>Our API backend receives requests such as those for reading, contextualization, and NDEX sharing. </li>
                                        <li>Our server logs the IP addresses which make reqeusts to the API.</li>
                                        <li>The data from some user requests is forwarded to external APIs such as TRIPS (reading) and cBioPortal (contextualization) in order to generate responses.</li> 
                                </ul>
                                </div>
                            </div>
                        </div>
                        <!-- panel 6 end -->   
                      </div>  
                  </div>
                </div>

              </div>
              </div>
            </div>
          </div>
        </div>

      </div>
  </div>
  <br>
  <div class="row">
    <div class="col-md-12">

      <!-- graph : start -->
      <!-- <h5>Graph</h5> -->
          <div id="cy-container" class="cy-container">
            <div id="cy_1" class="cy" data-url="static/cyjs/model_A101D_SKIN.json"></div>
        </div>
    <!-- graph : end -->
  </div>
  <div class="row" align="center">
    <div class="col-md-12">
              <b>Download</b>
              <button id='downloadINDRA' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Download the model statements generated by INDRA in JSON format.">INDRA JSON</button>
              <button id='downloadPySB' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA into an executable PySB model.">PySB</button>
              <button id='downloadSBML' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA as a SBML model.">SBML</button>
              <button id='downloadSBGN' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA as a SBGN model.">SBGN</button>
              <button id='downloadBNGL' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA as a BNGL model.">BNGL</button>
              <button id='downloadKappa' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA as a Kappa model.">Kappa</button>
              <button id='downloadCX' type="submit" class="btn btn-default hidden-xs" data-placement="bottom" data-toggle="tooltip" title="Assemble and download the model statements generated by INDRA as a Cytoscale CX model.">CX</button>
              <button id='downloadPNG' type="submit" class="btn btn-default" data-placement="bottom" data-toggle="tooltip" title="Download a high-resolution PNG image of the current model.">PNG</button>
              <span>|</span>
              <span rel="tooltip" data-placement="bottom" data-toggle="tooltip" title="Upload, download, and share the current model via NDEx.">
                  <button id='NDEX' type="submit" class="btn btn-default" data-toggle="modal" data-target="#ndexModal">NDEX</button>
              </span>
              <span>|</span>
              <span rel="tooltip" data-placement="bottom" data-toggle="tooltip" title="Toggle force-directed layout.">
                <input id="layoutToggle" type="checkbox" checked data-toggle="toggle" data-onstyle="primary" data-on="Forces" data-off="Off" autocomplete="off">
              </span>
              
    <!-- graph : end -->
  </div>
  </div>
  <!-- modal start -->
  <div class="modal fade" id="ndexModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="false">&times;</span></button>
          <h4 class="modal-title" id="exampleModalLabel">NDEX</h4>
        </div>
        <div class="modal-body">
                <div>
                    <h4>NDEX Download</h4>
                    <div class="form-group">
                        <label for="ndexUUID"></label>
                        <input type="email" class="form-control" id="ndexUUID" placeholder="e.g. - ea778a86-91b9-11e8-a4bf-0ac135e8bacf" autocomplete="off">
                    </div>
                    <div class= 'btn-div'>
                        <button id='loadNDEX' type="submit" class="btn btn-primary">Load</button>
                    </div>
                </div>
                <hr>
                <div>
                    <h4>NDEX Upload</h4>
                    <div class="ndex-upload-container"></div>
                    <button id='NDEX_upload_btn' type="submit" class="btn btn-primary">Upload</button>

                </div>   
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div> 
  <!-- modal end -->
  <!-- modal start -->
  <div class="modal" id="edgeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content modal-fullscreen">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="exampleModalLabel">Edge statements</h4>
        </div>
        <div class="modal-body">
            <h4>Sources</h4>
            <div class="edgeModal-sources btn-div"></div>
            <h4>Targets</h4>
            <div class="edgeModal-targets btn-div"></div>
            <br>
            <div class="edgeModal-stmtsbox"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!-- modal end -->
  </div>
    <!-- container-fluid : end -->
</body>
</html>
